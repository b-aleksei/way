(self.webpackChunk=self.webpackChunk||[]).push([[98],{5098:function(e,t,r){"use strict";r.r(t),r.d(t,{insertData:function(){return f}});var n=r(4549),a=function(e){var t=e.target,r="+".concat(7," (___) ___-__-__"),n=0,a=t.value.replace(/\D/g,"");a.length||(a="".concat(7)),t.value="",Array.prototype.forEach.call(r,(function(e){var r=/[_\d]/.test(e)&&a.length>n;t.value+=r?a.charAt(n++):a.length<=n?"":e}))},i=function e(t){var r=t.target;r.value==="+".concat(7)&&(r.value=""),r.removeEventListener("input",a),r.removeEventListener("blur",e)},s=r(5091);function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var c={regEmail:/^\s*[\w.-]+@[\w-]+\.(?:[\w-]+\.)?[A-Za-z]{2,8}\s*$/},l={required:"Поле не должно быть пустым",phone:"Неправильный номер",email:"Некорректный email"},d={success:"Ваша заявка принята",fail:"Удаленный сервер не найден",error:"Сетевая ошибка, проверьте интернет соединение"};fetch("data/errorMes.json").then((function(e){return e.json()})).then((function(e){return l=e})).catch((function(){})),fetch("data/statusMes.json").then((function(e){return e.json()})).then((function(e){return d=e})).catch((function(){}));var u=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.form="string"==typeof t?document.querySelector(t):t,this.form instanceof HTMLElement&&(this.defaultConfig={url:"https://jsonplaceholder.typicode.com/posts",classError:"form-invalid",statusMessages:d},this.config=Object.assign(this.defaultConfig,r),this.init())}var t,r;return t=e,(r=[{key:"init",value:function(){this.form.addEventListener("focusin",this),this.form.addEventListener("focusout",this),this.form.addEventListener("click",this),this.form.addEventListener("submit",this)}},{key:"handleEvent",value:function(e){var t,r,n=this;switch(e.type){case"focusin":e.target.hasAttribute("data-validate")&&(e.target.setCustomValidity(""),"phone"===e.target.dataset.validate&&((r=e.target).value||(r.value="+".concat(7)),r.addEventListener("input",a),r.addEventListener("blur",i)));break;case"focusout":e.target.hasAttribute("data-validate")&&this.checkValue(e.target);break;case"click":e.target.closest('[type="submit"]')&&(e.currentTarget.querySelectorAll("[data-validate]:not([disabled])").forEach((function(e){e.parentElement.classList.add("validate"),n.checkValue(e)})),this.form.checkValidity()||(this.form.addEventListener("animationend",this),this.form.classList.add(this.config.classError)));break;case"submit":e.preventDefault(),(t=this).beforeSending(t),fetch(t.config.url,{method:"post",body:new FormData(t.form)}).then((function(e){e.ok?(t.transferAction(t,"success"),t.form.reset(),t.form.querySelectorAll("[data-validate]:not(:disabled)").forEach((function(e){e.parentElement.classList.remove("validate")}))):t.transferAction(t,"fail")})).catch((function(){t.transferAction(t,"error")})).finally((function(){t.afterSending()}));break;case"animationend":this.form.classList.remove(this.config.classError),this.form.removeEventListener("animationend",this)}}},{key:"setErrorMes",value:function(e,t){var r=e.parentElement.querySelector("[data-error]");r&&(r.dataset.error=t),e.setCustomValidity(t)}},{key:"checkValue",value:function(e){if(e.parentElement.classList.remove("valid"),e.parentElement.classList.add("validate"),e.value||!e.required)if("email"!==e.dataset.validate||(e.value=e.value.trim(),!e.value||c.regEmail.test(e.value))){if("phone"===e.dataset.validate){var t=e.value.replace(/\D/g,"").length;if(e.value&&t<11)return void this.setErrorMes(e,l.phone)}e.parentElement.classList.add("valid")}else this.setErrorMes(e,l.email);else this.setErrorMes(e,l.required)}},{key:"beforeSending",value:function(){}},{key:"afterSending",value:function(){}},{key:"transferAction",value:function(e,t){"success"===t&&s.o.open("success-order")}}])&&o(t.prototype,r),e}(),f=function(e){if(e.starter&&e.modal){var t,r,a,i,s,o,c,l,d,f,v,m=e.modal.querySelector(".order-element"),h={id:(i=e.starter.closest(".product-card")).id,vendorCode:i.dataset.vendorCode,name:null===(t=i.querySelector(".product-card__desc"))||void 0===t?void 0:t.innerText,price:null===(r=i.querySelector(".product-card__price"))||void 0===r?void 0:r.innerText,img:null===(a=i.querySelector(".product-card__img"))||void 0===a?void 0:a.innerHTML};m.innerHTML='\n  <div class="order-element__wrap-img">'.concat((s=h).img,'</div>\n  <div class="order-element__info">\n    <span class="order-element__vendor">Арт. ').concat(s.vendorCode,'</span>\n    <p class="order-element__desc">').concat(s.name,'</p>\n    <div class="order-element__prices">\n      <span class="order-element__price">').concat(s.price,'</span>\n    </div>\n    <div class="order-element__count">\n      <button class="order-element__btn order-element__increase" type="button">+</button>\n      <span class="order-element__total">1</span>\n      <button class="order-element__btn order-element__decrease" type="button">-</button>\n    </div>\n    <a class="form__link" href="#!">Узнать больше</a>\n  </div>\n'),o=e.modal,c=o.querySelector(".order-element__total"),l=o.querySelector(".order-element__price"),d=o.querySelector("#product-count"),f=+l.innerHTML.replace(/[\s₽]/g,""),v=1,o.addEventListener("click",(function(e){var t=e.target.closest(".order-element__btn");t&&(t.classList.contains("order-element__increase")&&v++,t.classList.contains("order-element__decrease")&&v>1&&v--,d.value=v,c.innerText=v,l.innerText=(0,n.xG)(f*v))})),new u(".form--fast-order"),e.modal.querySelector("#product-id").value=h.id}}}}]);