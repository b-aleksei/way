"use strict";!function(){let modal=document.querySelector(".modal"),success=document.querySelector(".success"),modalWrap=modal.querySelector(".modal__wrap"),btnBye=document.querySelectorAll("a[class$='__bye']"),formFeedback=document.querySelector(".feedback__form"),phone=modal.querySelector("input[name=phone]"),email=modal.querySelector("input[name=email]"),phoneFeedback=formFeedback.querySelector("input[name=phone]"),emailFeedback=formFeedback.querySelector("input[name=email]"),btnCloseModal=modal.querySelector(".modal__close"),btnCloseSuccess=success.querySelector(".success__close"),form=modal.querySelector("form"),storagePhone="",storageEmail="",regCheckPhone=/^\+\d\s?\d{10}/,regCheckEmail=/([A-z0-9_.-]+)@([A-z0-9_.-]+).([A-z]{2,8})/,closeModalKey=function(e){"Escape"===e.key&&(modal.classList.remove("modal--block"),document.removeEventListener("keydown",closeModalKey),modal.removeEventListener("mousedown",closeModalMouse))},closeSuccessKey=function(e){"Escape"===e.key&&(success.classList.remove("success--block"),document.removeEventListener("keydown",closeSuccessKey),success.removeEventListener("mousedown",closeSuccessMouse))},closeModalMouse=function(e){e.stopPropagation(),e.target!==this&&e.target!==btnCloseModal||(modal.classList.remove("modal--block"),modalWrap.classList.remove("modal--error"),modal.removeEventListener("mousedown",closeModalMouse),document.removeEventListener("keydown",closeModalKey),phone.removeEventListener("input",checkInput),email.removeEventListener("input",checkInput))},closeSuccessMouse=function(e){e.stopPropagation(),e.target!==this&&e.target!==btnCloseSuccess||(success.classList.remove("success--block"),success.removeEventListener("mousedown",closeSuccessMouse),document.removeEventListener("keydown",closeSuccessKey),phone.removeEventListener("input",checkInput),email.removeEventListener("input",checkInput))},checkInput=function(){let conditionPhone=!this.value.match(regCheckPhone),conditionEmail=!this.value.match(regCheckEmail)&&""!==this.value,cssClass=this===phone||this===email?"modal__input--mistake":"feedback__input--mistake";(this===phone||this===phoneFeedback?conditionPhone:conditionEmail)?this.classList.add(cssClass):this.classList.remove(cssClass)},successSend=function(inp1,inp2){inp2.value&&localStorage.setItem("email",inp2.value),localStorage.setItem("phone",inp1.value),modal.classList.remove("modal--block"),success.classList.add("success--block"),document.addEventListener("keydown",closeSuccessKey),success.addEventListener("mousedown",closeSuccessMouse)};storageEmail=localStorage.getItem("email"),storagePhone=localStorage.getItem("phone"),storagePhone&&(phone.value=storagePhone,phoneFeedback.value=storagePhone),"undefined"!==storageEmail&&(email.value=storageEmail,emailFeedback.value=storageEmail),phoneFeedback.addEventListener("input",checkInput),emailFeedback.addEventListener("input",checkInput);try{btnBye.forEach(item=>{item.addEventListener("click",(function(evt){evt.preventDefault(),modal.classList.add("modal--block"),phone.focus(),phone.addEventListener("input",checkInput),email.addEventListener("input",checkInput),document.addEventListener("keydown",closeModalKey),modal.addEventListener("mousedown",closeModalMouse)}))})}catch(e){console.log(e)}form.addEventListener("submit",(function(evt){successSend(phone,email),evt.preventDefault()})),formFeedback.addEventListener("submit",(function(evt){successSend(phone,email),evt.preventDefault()}))}();